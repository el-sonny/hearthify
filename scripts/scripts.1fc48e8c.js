"use strict";function mainCtrl(a,b,c,d){function e(){j.setClasses(),j.searchSlots=[{index:1},{index:2},{index:3}]}function f(a,b){a(b)}function g(b){a.addCard(b),j.searchSlots=j.searchSlots.map(function(a){return a.selected=!1,a.searchText=null,a})}function h(a){j.selectedClass=a,c.playerClass=a}function i(){return j.classes=d.classes,j.classes}var j=this;j.activate=e,j.openMenu=f,j.chooseCard=g,j.selectClass=h,j.setClasses=i,j.info={},j.searchSlots=[],j.selectedClass=c.playerClass,j.deck=a.cards,e()}function hearthApi(a,b){function c(){return a.all("cards").getList().then(f)}function d(){return a.one("info").get().then(g)}function e(b,c){return a.one("cards","search").getList(b,{collectible:1})}function f(a){return h.cards=a,a}function g(a){return h.info=a,a}var h=this;h.getAllCards=c,h.getInfo=d,h.search=e,h.setCards=f,h.setInfo=g,h.cards={},h.info={},a.setErrorInterceptor(function(a,b){404===a.status&&b.resolve([])})}function imageonload(){function a(a,b,c){b.bind("load",function(){a.loaded()})}return{link:a,restrict:"A",scope:{loaded:"&"}}}function cardSearch(){function a(a,b,c){}function b(a,b,c){function d(){}function e(){if(i.selectedCard){var a=parseInt(i.selectedCard.value),b=[{label:"Amazing",thresh:90,color:"Indigo"},{label:"Great",thresh:80,color:"Green"},{label:"Good",thresh:70,color:"Olive"},{label:"Above Average",thresh:60,color:"Khaki"},{label:"Average",thresh:50,color:"Gold"},{label:"Below Average",thresh:40,color:"Orange"},{label:"Bad",thresh:30,color:"OrangeRed"},{label:"Terrible",thresh:0,color:"Red"}];return b.find(function(c,d){return d?a>=c.thresh&&a<b[d-1].thresh:a>=c.thresh})}}function f(){i.imgIsLoaded=!0,c.$apply()}function g(b){return a.search(b)}function h(a){i.imgIsLoaded=!1,i.selectedCard=a,b.checkCard(a,i.tierList).then(function(a){a?i.selectedCard.value=a[1]:i.selectedCard.value="n/a"})}var i=this;i.activate=d,i.getTier=e,i.imgLoaded=f,i.queryCards=g,i.selectCard=h,i.tierList="hearth-arena",d()}return b.$inject=["hearthApi","listService","$scope"],{bindToController:!0,controller:b,controllerAs:"vm",link:a,restrict:"EA",scope:{chooseCard:"&",selectedCard:"=",searchText:"=",tabIndex:"="},templateUrl:"views/card-search.html"}}function listService(a,b,c){function d(){g.lists={"hearth-arena":{Druid:[],Shaman:[],Mage:[],Warlock:[],Warrior:[],Priest:[],Paladin:[],Hunter:[],Rogue:[]}}}function e(a,c){var d=b.defer(),e=g.lists[c][g.playerClass.name];if(e.length)if(a){var f=e.find(function(b){return b[0]===a.name});d.resolve(f)}else d.reject();else g.loadList(c,g.playerClass.name).then(function(){var b=g.checkCard(a,c);d.resolve(b)});return d.promise}function f(c,d){var e=b.defer();return g.lists[c][d].length?e.resolve(g.lists[c][d]):a.get("lists/"+c+"/"+d+".csv").then(function(a){var b=Papa.parse(a.data).data;g.lists[c][d]=b,e.resolve(b)}),e.promise}var g=this;g.activate=d,g.checkCard=e,g.loadList=f,g.lists={},g.playerClass=c.classes[0],d()}function deckService(){function a(a){var c=b.cards.findIndex(function(b){return b.cardId===a.cardId});-1>=c?(a.count=1,console.log("new card"),b.cards.push(a)):b.cards[c].count+=1}var b=this;b.addCard=a,b.cards=[]}function playerClassService(){function a(){b.classes=[{name:"Druid",image:"images/player-class/Druid.eefd4aa5.jpg"},{name:"Hunter",image:"images/player-class/Hunter.ec7feaf5.jpg"},{name:"Mage",image:"images/player-class/Mage.32eb7d84.jpg"},{name:"Paladin",image:"images/player-class/Paladin.2b6ef963.jpg"},{name:"Priest",image:"images/player-class/Priest.6bcc5457.jpg"},{name:"Rogue",image:"images/player-class/Rogue.e7a55ce0.jpg"},{name:"Shaman",image:"images/player-class/Shaman.d7a7b152.jpg"},{name:"Warlock",image:"images/player-class/Warlock.d79d8c49.jpg"},{name:"Warrior",image:"images/player-class/Warrior.d232d071.jpg"}]}var b=this;b.activate=a,b.classes=[],a()}angular.module("hearthifyApp",["ngAnimate","ngAria","ngRoute","ngSanitize","ngMaterial","restangular"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}]),angular.module("hearthifyApp").config(["RestangularProvider",function(a){a.setDefaultHeaders({"X-Mashape-Key":"VzmtuqVrkimshv2u8P4w9f9DUFtgp1SOM1ejsneCCd1lVJuVEM"}),a.setBaseUrl("https://omgvamp-hearthstone-v1.p.mashape.com/")}]),angular.module("hearthifyApp").controller("MainCtrl",mainCtrl),mainCtrl.$inject=["deckService","hearthApi","listService","playerClassService"],angular.module("hearthifyApp").service("hearthApi",hearthApi),hearthApi.$inject=["Restangular","$q"],angular.module("hearthifyApp").directive("imageonload",imageonload),angular.module("hearthifyApp").directive("cardSearch",cardSearch),angular.module("hearthifyApp").service("listService",listService),listService.$inject=["$http","$q","playerClassService"],angular.module("hearthifyApp").service("deckService",deckService),angular.module("hearthifyApp").service("playerClassService",playerClassService),angular.module("hearthifyApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/card-search.html",'<div layout="column" layout-fill class="md-padding card-search"> <md-autocomplete md-search-text="vm.searchText" md-selected-item-change="vm.selectCard(item)" md-items="item in vm.queryCards(vm.searchText)" md-item-text="item.name" md-min-length="2" md-delay="200" placeholder="Search Cards"> <md-item-template> <div layout="row"> <span flex md-highlight-text="vm.searchText" md-highlight-flags="^i">{{item.name}}</span> <span>{{item.playerClass}}</span> </div> </md-item-template> <md-not-found> No cards matching "{{vm.searchText}}" were found. </md-not-found> </md-autocomplete> <div ng-show="vm.selectedCard" class="cardbox" layout="row" ng-click="vm.chooseCard()(vm.selectedCard)"> <div flex> <h4>{{vm.selectedCard.name}}</h4> <p> <md-button class="md-fab" aria-label="{{vm.selectedCard.value}}" ng-style="{&quot;background-color&quot;:vm.getTier().color || &quot;black&quot;}"> {{vm.selectedCard.value}} </md-button> {{vm.getTier().label}} </p> <p> Type: {{vm.selectedCard.type}} <br>Cost: {{vm.selectedCard.cost}} <br>Rarity: {{vm.selectedCard.rarity}} <br>Card Set: {{vm.selectedCard.cardSet}} <br><span ng-if="vm.selectedCard.playerClass">{{vm.selectedCard.playerClass}}</span> </p> <p><i>{{vm.selectedCard.flavor}}</i></p> </div> <div class="img-container" layout layout-align="center center"> <md-progress-circular md-mode="indeterminate" ng-show="!vm.imgIsLoaded" md-diameter="120"></md-progress-circular> <img ng-src="{{vm.selectedCard.img}}" imageonload loaded="vm.imgLoaded()" ng-show="vm.imgIsLoaded"> </div> </div> </div>'),a.put("views/main.html",'<md-toolbar> <div class="md-toolbar-tools"> <h2> <span>Arena Helper</span> </h2> <span flex></span> <md-menu md-offset="0 45"> <md-button aria-label="Open player class interactions menu" class="md-raised" ng-click="vm.openMenu($mdOpenMenu, $event)"> <span md-menu-origin>Selected Class : {{vm.selectedClass.name}}</span> </md-button> <md-menu-content width="3"> <md-menu-item ng-repeat="class in vm.classes"> <md-button ng-click="vm.selectClass(class)"> {{class.name}} </md-button> </md-menu-item> </md-menu-content> </md-menu> </div> </md-toolbar> <md-divider></md-divider> <md-content class="md-padding" layout="row"> <md-button class="md-fab md-primary" aria-label="Step 1">1</md-button> <h2>Select Class</h2> </md-content> <md-content class="md-padding" layout="row" layout-wrap layout-align="center center"> <div class="player-class" ng-repeat="class in vm.classes" ng-class="{selected : vm.selectedClass === class}"> <md-button ng-click="vm.selectClass(class)" md-class="md-fab" aria-label="Select {{class.name}}"> <img ng-src="{{class.image}}"> <p>{{class.name}}</p> </md-button> </div> </md-content> <md-divider></md-divider> <div layout="row" class="md-padding search-spot"> <card-search flex ng-repeat="slot in vm.searchSlots" choose-card="vm.chooseCard" selected-card="slot.selected" search-text="slot.searchText"></card-search> </div> <div class="md-padding" ng-show="vm.deck.length"> <h3>Deck</h3> <md-content flex layout="row" layout-wrap> <div ng-repeat="card in vm.deck" class="deck-box"> <img ng-src="{{card.img}}"> </div> </md-content> </div>')}]);